{
  "rules": {
    ".read": "auth != null",
    ".write": "auth != null",
    "emails": {
      "$recipientEmail": {
        ".validate": "newData.child('sender').val() === auth.token.email || newData.child('to').val() === auth.token.email",
        "$emailId": {
          ".validate": "newData.child('sender').val() === auth.token.email"
        }
      },
      "sent": {
        ".validate": "newData.child('sender').val() === auth.token.email",
        "$emailId": {
          ".validate": "newData.child('sender').val() === auth.token.email"
        }
      }
    }
  }
}
